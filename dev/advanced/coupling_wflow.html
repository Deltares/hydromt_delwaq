

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Coupling with Wflow &mdash; hydromt_delwaq  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HydroMT and DELWAQ settings" href="generic_delwaq.html" />
    <link rel="prev" title="hydromt_delwaq.workflows.segments.pointer" href="../generated/hydromt_delwaq.workflows.segments.pointer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> hydromt_delwaq
          

          
          </a>

          
            
            
              <div class="version">
                0.1.1.dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/components.html">Model components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/build_configuration.html">Model configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/attributes.html">Model attributes</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced topics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Workflows</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Coupling with Wflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#concepts-of-the-wflow-delwaq-coupling">Concepts of the Wflow - Delwaq coupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hydrological-forcing-from-wflow">Hydrological forcing from Wflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generic_delwaq.html">HydroMT and DELWAQ settings</a></li>
</ul>
<p class="caption"><span class="caption-text">References &amp; Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/api_index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hydromt_delwaq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Coupling with Wflow</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/advanced/coupling_wflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="coupling-with-wflow">
<span id="coupling-wflow"></span><h1>Coupling with Wflow<a class="headerlink" href="#coupling-with-wflow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="concepts-of-the-wflow-delwaq-coupling">
<h2>Concepts of the Wflow - Delwaq coupling<a class="headerlink" href="#concepts-of-the-wflow-delwaq-coupling" title="Permalink to this headline">¶</a></h2>
<p>Water quality and emission, fate and transport of pollutants through the landscape is very much linked to the water movements. In most cases, pollutants are emitted on land and
either leach into the soil or are picked up by water during rain events and transported towards and into the rivers. In order to model water quality is it therefore essential to first understand and assess the hydrology of the catchment / region of interests.</p>
<p>A full hydrology - water quality modelling suite is in general separated in three parts:</p>
<ul class="simple">
<li><p>the hydrological model, <em>wflow_sbm</em>, that predicts water movements through the catchments.</p></li>
<li><p>an emission model, <em>D-Emission</em> (also referred to as EM in hydroMT), that predicts the quantity (fluxes) of substances being released from sources of pollutants to the surface waters (mass/time).</p></li>
<li><p>a fate and transport model, <em>D-Water Quality</em> (also referred to as WQ in hydroMT), that predicts the fate and transport of substances in the surface waters (concentrations in mass / volume).</p></li>
</ul>
<img alt="../_images/wflow-Delwaq.jpg" src="../_images/wflow-Delwaq.jpg" />
<p>For the purpose of modelling catchment water quality, the wflow_sbm model has been linked to EM and WQ (both based on Delwaq, Deltares water quality software) using a “coupling” function integrated in the
HydroMT-Delwaq plugin.</p>
<p>The wflow-Delwaq coupling function in hydroMT:</p>
<ul class="simple">
<li><p>translates wflow schematization to Delwaq schematization;</p></li>
<li><p>prepares static inputs needed for water quality modelling (emission sources, locators…);</p></li>
<li><p>prepares dynamic inputs needed for water quality modelling (different water fluxes and volumes);</p></li>
<li><p>supports the modelling of different types of pollutants.</p></li>
</ul>
<p>A full hydrology - water quality modelling suite is setup and run using the following steps:</p>
<ol class="upperalpha simple">
<li><p>Hydrological modelling with wflow</p></li>
</ol>
<ul class="simple">
<li><p>Run wflow in order to prepare the hydrological fluxes required by EM and WQ.</p></li>
</ul>
<ol class="upperalpha simple" start="2">
<li><p>Emissions modelling with D-Emissions</p></li>
</ol>
<ul class="simple">
<li><p>Setup the EM model from wflow and emission data using hydroMT</p></li>
<li><p>Edit the EM run info and run D-Emission (EM-Plugin)</p></li>
</ul>
<ol class="upperalpha simple" start="3">
<li><p>Fate and transport modelling with D-Water Quality</p></li>
</ol>
<ul class="simple">
<li><p>Setup the WQ model from wflow and emission data using hydroMT</p></li>
<li><p>Link EM results to WQ</p></li>
<li><p>Edit the WQ run info and run D-Water Quality (WQ-Plugin)</p></li>
</ul>
</div>
<div class="section" id="hydrological-forcing-from-wflow">
<h2>Hydrological forcing from Wflow<a class="headerlink" href="#hydrological-forcing-from-wflow" title="Permalink to this headline">¶</a></h2>
<p>In order to determine how and where substances are emitted and how they move through the landscape via the surface water, water quality modelling requires certain
hydrological information.</p>
<p>For an EM type of model (emission of substances in the surface waters), the required information is:</p>
<ul class="simple">
<li><p><strong>precipitation</strong>;</p></li>
<li><p>the amount of the precipitation that <strong>infiltrates</strong> into the soil from unpaved areas;</p></li>
<li><p>the amount of the precipitation that goes directly <strong>to surface runoff from paved areas</strong>;</p></li>
<li><p>the amount of the precipitation that goes directly <strong>to surface runoff from unpaved areas</strong>.</p></li>
</ul>
<p>For a WQ type of model (fate and transport of substances in the surface waters), the required information is:</p>
<ul class="simple">
<li><p><strong>Surface runoff</strong></p></li>
<li><p><strong>Surface water volumes</strong></p></li>
<li><p><strong>Total water entering the surface waters</strong> (e.g. precipitation, exfiltration from the soil, evaporation…) in order to close the surface water mass balance.</p></li>
</ul>
<p>Wflow separates and routes water for three different components, the surface waters on the land, the river surface water and the water in the soil. Delwaq uses only the one surface water components
and therefore the river and land surface waters from wflow are saved together for Delwaq. The corresponding water balances for the river and land surface waters in wflow are shown in the Figure below.
In order to prepare hydrological fluxes for Delwaq from wflow, Wflow should be run and the required fluxes saved (same order as above):</p>
<ul class="simple">
<li><p>vertical.precipitation (precipitation input)</p></li>
<li><p>vertical.actinfilt (infiltration in the soil)</p></li>
<li><p>vertical.excesswaterpath (infiltration excess runoff on paved areas)</p></li>
<li><p>vertical.excesswatersoil (infiltration excess runoff on unpaved areas)</p></li>
<li><p>lateral.river.q_av and lateral.land.q_av (runoff in the river and land kinematic wave)</p></li>
<li><p>lateral.river.volume and lateral.land.volume (kinematic wave volume in the river and on the land)</p></li>
<li><p>lateral.river.inwater, lateral.land.inwater and lateral.land.to_river (inwater river/land is the sum of all fluxes reaching the kinematic wave of the river/land surface water. As
inwater also contains an internal flux between the land and river water, the part of land runoff that reaches the river lateral.land.to_river, we will need to substract
it to not count it twice, see Figure below).</p></li>
</ul>
<img alt="../_images/wflow_balances.png" src="../_images/wflow_balances.png" />
<p>Figure of the Wflow water balances for the land surface water (top left), river surface water (top right) and the total surface water (bottom).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="generic_delwaq.html" class="btn btn-neutral float-right" title="HydroMT and DELWAQ settings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../generated/hydromt_delwaq.workflows.segments.pointer.html" class="btn btn-neutral float-left" title="hydromt_delwaq.workflows.segments.pointer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Deltares.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>